<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="styles.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Markdown Viewer</title>
    <link rel="icon" type="image/x-icon" href="favicons/favicon.ico">
    <link rel="icon" type="image/svg+xml" href="favicons/favicon.svg">
    <link rel="icon" type="image/png" sizes="96x96" href="favicons/favicon-96x96.png">
    <link rel="apple-touch-icon" href="favicons/apple-touch-icon.png">
    <link rel="manifest" href="favicons/site.webmanifest">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/loader.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Load jsPDF with AMD conflict prevention -->
    <script>
      // Temporarily disable AMD to prevent conflicts with jsPDF
      if (typeof define === 'function' && define.amd) {
        window.__amdBackup = define;
        delete window.define;
      }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
      // Restore AMD after jsPDF loads
      if (window.__amdBackup) {
        window.define = window.__amdBackup;
        delete window.__amdBackup;
      }
    </script>
  </head>

  <body>
    <!-- Load splash screen component first -->
    <script src="/splash-component.js"></script>

    <div class="app">
      <!-- Toolbar -->
      <div class="toolbar">
        <div class="toolbar-left">
          <button id="new-btn" class="toolbar-btn">üìÑ New</button>
          <button id="open-btn" class="toolbar-btn">üìÅ Open</button>
          <div class="dropdown-container">
            <button id="save-btn" class="toolbar-btn dropdown-main">üíæ Save</button>
            <button id="save-dropdown-arrow" class="toolbar-btn dropdown-arrow">‚ñº</button>
            <div id="save-dropdown-menu" class="dropdown-menu">
              <button id="save-as-btn" class="dropdown-item">Save As</button>
            </div>
          </div>
          <button id="close-btn" class="toolbar-btn">‚ùå Close</button>
        </div>
        <div class="toolbar-center">
          <button id="code-btn" class="mode-btn">Code</button>
          <button id="preview-btn" class="mode-btn active">Preview</button>
          <button id="split-btn" class="mode-btn">Split</button>
        </div>
        <div class="toolbar-right">
          <div class="dropdown-container">
            <button id="export-btn" class="toolbar-btn dropdown-toggle">Export ‚ñº</button>
            <div id="export-dropdown-menu" class="dropdown-menu">
              <button id="export-html-btn" class="dropdown-item">HTML</button>
              <button id="export-pdf-btn" class="dropdown-item">PDF</button>
            </div>
          </div>
          <button id="distraction-btn" class="toolbar-btn" title="Toggle Distraction-Free Mode (Shift+F11)">üî≥</button>
          <button id="theme-btn" class="toolbar-btn" title="Toggle Theme (Ctrl+T)">üåô</button>
          <button id="settings-btn" class="toolbar-btn" title="Settings (Ctrl+,)">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="13" height="13" fill="currentColor">
              <path d="M195.1 9.5C198.1-5.3 211.2-16 226.4-16l59.8 0c15.2 0 28.3 10.7 31.3 25.5L332 79.5c14.1 6 27.3 13.7 39.3 22.8l67.8-22.5c14.4-4.8 30.2 1.2 37.8 14.4l29.9 51.8c7.6 13.2 4.9 29.8-6.5 39.9L447 233.3c.9 7.4 1.3 15 1.3 22.7s-.5 15.3-1.3 22.7l53.4 47.5c11.4 10.1 14 26.8 6.5 39.9l-29.9 51.8c-7.6 13.1-23.4 19.2-37.8 14.4l-67.8-22.5c-12.1 9.1-25.3 16.7-39.3 22.8l-14.4 69.9c-3.1 14.9-16.2 25.5-31.3 25.5l-59.8 0c-15.2 0-28.3-10.7-31.3-25.5l-14.4-69.9c-14.1-6-27.2-13.7-39.3-22.8L73.5 432.3c-14.4 4.8-30.2-1.2-37.8-14.4L5.8 366.1c-7.6-13.2-4.9-29.8 6.5-39.9l53.4-47.5c-.9-7.4-1.3-15-1.3-22.7s.5-15.3 1.3-22.7L12.3 185.8c-11.4-10.1-14-26.8-6.5-39.9L35.7 94.1c7.6-13.2 23.4-19.2 37.8-14.4l67.8 22.5c12.1-9.1 25.3-16.7 39.3-22.8L195.1 9.5zM256.3 336a80 80 0 1 0 -.6-160 80 80 0 1 0 .6 160z"/>
            </svg>
          </button>
          <button id="help-status-btn" class="toolbar-btn" title="Help (F1)">‚ùì</button>
        </div>
      </div>

      <!-- Markdown Toolbar -->
      <div id="markdown-toolbar" class="markdown-toolbar">
        <div class="toolbar-content">
          <div class="toolbar-group">
            <button id="undo-btn" class="md-btn" title="Undo (Ctrl+Z)">‚Ü∂</button>
            <button id="redo-btn" class="md-btn" title="Redo (Ctrl+Y)">‚Ü∑</button>
          </div>
          <div class="toolbar-separator"></div>
          <!-- Headings -->
          <div class="toolbar-group">
            <button class="md-btn" data-action="h1" title="Heading 1 (Ctrl+1)">H1</button>
            <button class="md-btn" data-action="h2" title="Heading 2 (Ctrl+2)">H2</button>
            <button class="md-btn" data-action="h3" title="Heading 3 (Ctrl+3)">H3</button>
          </div>
          <div class="toolbar-separator"></div>
          
          <!-- Text Formatting -->
          <div class="toolbar-group">
            <button class="md-btn" data-action="bold" title="Bold (Ctrl+B)"><strong>B</strong></button>
            <button class="md-btn" data-action="italic" title="Italic (Ctrl+I)"><em>I</em></button>
            <button class="md-btn" data-action="strikethrough" title="Strikethrough"><del>S</del></button>
            <button class="md-btn" data-action="underline" title="Underline (Ctrl+Shift+U)"><u>U</u></button>
          </div>
          <div class="toolbar-separator"></div>
          
          <!-- Links & Media -->
          <div class="toolbar-group">
            <button class="md-btn" data-action="link" title="Link (Ctrl+K)">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
              </svg>
            </button>
            <button class="md-btn" data-action="image" title="Image">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21,15 16,10 5,21"></polyline>
              </svg>
            </button>
          </div>
          <div class="toolbar-separator"></div>
          
          <!-- Lists & Structure -->
          <div class="toolbar-group">
            <button class="md-btn" data-action="ul" title="Unordered List">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="10" y1="6" x2="21" y2="6"></line>
                <line x1="10" y1="12" x2="21" y2="12"></line>
                <line x1="10" y1="18" x2="21" y2="18"></line>
                <circle cx="4" cy="6" r="2"></circle>
                <circle cx="4" cy="12" r="2"></circle>
                <circle cx="4" cy="18" r="2"></circle>
              </svg>
            </button>
            <button class="md-btn" data-action="ol" title="Ordered List">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="10" y1="6" x2="21" y2="6"></line>
                <line x1="10" y1="12" x2="21" y2="12"></line>
                <line x1="10" y1="18" x2="21" y2="18"></line>
                <text x="4" y="9" font-size="8" fill="currentColor">1</text>
                <text x="4" y="15" font-size="8" fill="currentColor">2</text>
                <text x="4" y="21" font-size="8" fill="currentColor">3</text>
              </svg>
            </button>
            <button class="md-btn" data-action="task" title="Task List">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="10" y1="6" x2="21" y2="6"></line>
                <line x1="10" y1="12" x2="21" y2="12"></line>
                <line x1="10" y1="18" x2="21" y2="18"></line>
                <rect x="2" y="4" width="4" height="4" rx="1"></rect>
                <rect x="2" y="10" width="4" height="4" rx="1"></rect>
                <rect x="2" y="16" width="4" height="4" rx="1"></rect>
                <polyline points="3,6 4,7 5,5"></polyline>
              </svg>
            </button>
            <button class="md-btn" data-action="table" title="Table">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="9" y1="3" x2="9" y2="21"></line>
                <line x1="15" y1="3" x2="15" y2="21"></line>
                <line x1="3" y1="9" x2="21" y2="9"></line>
                <line x1="3" y1="15" x2="21" y2="15"></line>
              </svg>
            </button>
          </div>
          <div class="toolbar-separator"></div>
          
          <!-- Code & Quotes -->
          <div class="toolbar-group">
            <button class="md-btn" data-action="code" title="Inline Code">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="16,18 22,12 16,6"></polyline>
                <polyline points="8,6 2,12 8,18"></polyline>
              </svg>
            </button>
            <button class="md-btn" data-action="codeblock" title="Code Block">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                <line x1="8" y1="21" x2="16" y2="21"></line>
                <line x1="12" y1="17" x2="12" y2="21"></line>
              </svg>
            </button>
            <button class="md-btn" data-action="quote" title="Blockquote">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z"></path>
                <path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z"></path>
              </svg>
            </button>
          </div>
          <div class="toolbar-separator"></div>
          
          <!-- Text Alignment -->
          <div class="toolbar-group">
            <button class="md-btn" data-action="align-left" title="Align Left">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="12" x2="15" y2="12"></line>
                <line x1="3" y1="18" x2="18" y2="18"></line>
              </svg>
            </button>
            <button class="md-btn" data-action="align-center" title="Align Center">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="6" y1="12" x2="18" y2="12"></line>
                <line x1="4" y1="18" x2="20" y2="18"></line>
              </svg>
            </button>
            <button class="md-btn" data-action="align-right" title="Align Right">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="7" y1="12" x2="21" y2="12"></line>
                <line x1="5" y1="18" x2="21" y2="18"></line>
              </svg>
            </button>
            <button class="md-btn" data-action="align-justify" title="Justify">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
              </svg>
            </button>
          </div>
          
          <div style="flex: 1;"></div>
          
          <div class="toolbar-group">
            <button id="find-replace-btn" class="md-btn" title="Find & Replace (Ctrl+F)">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
              </svg>
            </button>
          </div>

        </div>
      </div>

      <!-- Main Content -->
      <div class="main-content">
        <!-- Editor Pane -->
        <div class="editor-pane">
          <div id="monaco-editor" class="monaco-editor-container"></div>
          <textarea id="editor" style="display: none;" placeholder="# Welcome to Markdown Viewer\n\nStart typing your markdown here..."></textarea>
        </div>
        
        <!-- Splitter -->
        <div id="splitter" class="splitter" style="display: none;"></div>
        
        <!-- Preview Pane -->
        <div class="preview-pane">
          <div id="welcome-page" class="welcome-page">
            <div class="welcome-content">
              <h1><img src="assets/icon.svg" alt="" class="favicon-icon"> Markdown Editor</h1>
              <p class="welcome-subtitle">A light, yet powerful markdown editor with live preview</p>
              
              <div class="welcome-actions">
                <button id="welcome-new-btn" class="welcome-btn primary">üìÑ New File</button>
                <button id="welcome-open-btn" class="welcome-btn">üìÅ Open File</button>
              </div>
              
              <div id="file-history-section" class="file-history" style="display: none;">
                <h3>Recent Files</h3>
                <div id="file-history-list" class="file-history-list"></div>
                <button id="clear-history-btn" class="welcome-btn clear-btn">Clear History</button>
              </div>
              
              <div class="welcome-actions-grid">
                <h3>Quick Actions</h3>
                <div class="action-buttons">
                  <button id="welcome-help-btn" class="welcome-btn action-btn">Shortcuts</button>
                  <button id="welcome-about-btn" class="welcome-btn action-btn">About</button>
                  <button id="welcome-settings-btn" class="welcome-btn action-btn">Settings</button>
                </div>
              </div>
            </div>
          </div>
          <div id="preview" class="preview-content" style="display: none;">
            <h1>Welcome to Markdown Viewer</h1>
            <p>Start typing your markdown here...</p>
          </div>
        </div>
      </div>

      <!-- Pinned Tabs Bar -->
      <div id="pinned-tabs-bar" class="pinned-tabs-bar" style="display: none;">
        <div id="pinned-tabs-list" class="pinned-tabs-list"></div>
      </div>

      <!-- Status Bar -->
      <div class="status-bar">
        <div class="status-left">
          <span id="cursor-pos">Line 1, Col 1</span>
        </div>
        <div class="status-center">
          <button id="scroll-sync-btn" class="status-btn sync-btn" style="display: none;" title="Sync scroll position">
            ‚áÑ
          </button>
          <div id="font-size-controls" class="font-size-controls" style="display: none;">
            <button id="font-size-decrease" class="status-btn font-btn" title="Decrease Font Size">A-</button>
            <span id="font-size-display" class="font-size-display">14px</span>
            <button id="font-size-increase" class="status-btn font-btn" title="Increase Font Size">A+</button>
            <button id="font-size-reset" class="status-btn font-btn" title="Reset Font Size">Reset</button>
          </div>
          <div id="zoom-controls" class="zoom-controls" style="display: none;">
            <button id="zoom-out" class="status-btn zoom-btn" title="Zoom Out (Ctrl+-)">üîéÔ∏é‚àí</button>
            <span id="zoom-display" class="zoom-display">100%</span>
            <button id="zoom-in" class="status-btn zoom-btn" title="Zoom In (Ctrl+=)">üîéÔ∏éÔºã</button>
            <button id="zoom-reset" class="status-btn zoom-btn" title="Reset Zoom (Ctrl+0)">Reset</button>
          </div>
        </div>
        <div class="status-right">
          <button id="reload-btn" class="status-btn" title="Reload File (F5)">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="23,4 23,10 17,10"></polyline>
              <polyline points="1,20 1,14 7,14"></polyline>
              <path d="M20.49,9A9,9,0,0,0,5.64,5.64L1,10m22,4L18.36,18.36A9,9,0,0,1,3.51,15"></path>
            </svg>
          </button>
          <div id="tab-dropdown" class="tab-dropdown">
            <button id="filename" class="filename-btn">untitled.md</button>
            <div id="tab-dropdown-menu" class="tab-dropdown-menu">
              <div id="tab-dropdown-list" class="tab-dropdown-list"></div>
              <button id="tab-more-btn" class="tab-more-btn" style="display: none;">More...</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Enhanced Settings Modal -->
      <div id="settings-modal" class="settings-modal" style="display: none;">
        <div class="settings-overlay"></div>
        <div class="settings-window">
          <div class="settings-header">
            <h2>Settings</h2>
            <button id="settings-close-btn" class="settings-close-btn">√ó</button>
          </div>
          <div class="settings-content">
            <div class="settings-section">
              <h3>Appearance</h3>
              <div class="setting-item">
                <label>Theme</label>
                <div class="setting-control">
                  <button id="theme-light-btn" class="setting-btn">Light</button>
                  <button id="theme-dark-btn" class="setting-btn">Dark</button>
                  <button id="theme-retro-btn" class="setting-btn">Retro</button>
                  <button id="theme-contrast-btn" class="setting-btn">High Contrast</button>
                </div>
              </div>
              <div class="setting-item retro-sound-setting" style="display: none;">
                <label>
                  <input type="checkbox" id="retro-sound-checkbox" class="retro-checkbox" checked>
                  Startup Sound
                </label>
                <button id="test-startup-sound-btn" class="setting-btn test-sound-btn" title="Test startup sound">üîä Test</button>
              </div>
            </div>
            
            <div class="settings-section">
              <h3>Editor</h3>
              <div class="setting-item">
                <label>Default Mode</label>
                <div class="setting-control">
                  <button id="mode-code-btn" class="setting-btn">Code</button>
                  <button id="mode-preview-btn" class="setting-btn">Preview</button>
                  <button id="mode-split-btn" class="setting-btn">Split</button>
                </div>
              </div>
              <div class="setting-item">
                <label>Text Suggestions</label>
                <div class="setting-control">
                  <button id="suggestions-on-btn" class="setting-btn">Enabled</button>
                  <button id="suggestions-off-btn" class="setting-btn">Disabled</button>
                </div>
              </div>

              <div class="setting-item">
                <label>Markdown Toolbar</label>
                <div class="setting-control">
                  <button id="toolbar-on-btn" class="setting-btn">Enabled</button>
                  <button id="toolbar-off-btn" class="setting-btn">Disabled</button>
                </div>
              </div>

              <div class="setting-item">
                <label>Pinned Tabs</label>
                <div class="setting-control">
                  <button id="pinned-tabs-on-btn" class="setting-btn">Enabled</button>
                  <button id="pinned-tabs-off-btn" class="setting-btn">Disabled</button>
                </div>
              </div>

              <div class="setting-item">
                <label>Splash Screen</label>
                <div class="setting-control">
                  <button id="splash-on-btn" class="setting-btn">Enabled</button>
                  <button id="splash-off-btn" class="setting-btn">Disabled</button>
                </div>
              </div>
              <div class="setting-item" id="splash-duration-setting">
                <label>Splash Duration (seconds)</label>
                <div class="setting-control">
                  <button id="splash-1s-btn" class="setting-btn">1</button>
                  <button id="splash-2s-btn" class="setting-btn">2</button>
                  <button id="splash-3s-btn" class="setting-btn">3</button>
                  <button id="splash-4s-btn" class="setting-btn">4</button>
                  <button id="splash-5s-btn" class="setting-btn">5</button>
                </div>
              </div>
            </div>
            
            <div class="settings-section">
              <h3>Interface</h3>
              <div class="setting-item">
                <label>Main Toolbar Size</label>
                <div class="setting-control">
                  <button id="main-toolbar-small" class="setting-btn">Small</button>
                  <button id="main-toolbar-medium" class="setting-btn">Medium</button>
                  <button id="main-toolbar-large" class="setting-btn">Large</button>
                </div>
              </div>
              <div class="setting-item">
                <label>Markdown Toolbar Size</label>
                <div class="setting-control">
                  <button id="md-toolbar-small" class="setting-btn">Small</button>
                  <button id="md-toolbar-medium" class="setting-btn">Medium</button>
                  <button id="md-toolbar-large" class="setting-btn">Large</button>
                </div>
              </div>
              <div class="setting-item">
                <label>Status Bar Size</label>
                <div class="setting-control">
                  <button id="status-bar-small" class="setting-btn">Small</button>
                  <button id="status-bar-medium" class="setting-btn">Medium</button>
                  <button id="status-bar-large" class="setting-btn">Large</button>
                </div>
              </div>
            </div>
            
            <div class="settings-section">
              <h3>Layout</h3>
              <div class="setting-item">
                <label>Centered Layout</label>
                <div class="setting-control">
                  <button id="layout-on-btn" class="setting-btn">Enabled</button>
                  <button id="layout-off-btn" class="setting-btn">Disabled</button>
                </div>
              </div>
              <div class="setting-item">
                <label>Page Size</label>
                <div class="setting-control">
                  <button id="page-a4-btn" class="setting-btn">A4</button>
                  <button id="page-letter-btn" class="setting-btn">Letter</button>
                  <button id="page-a3-btn" class="setting-btn">A3</button>
                </div>
              </div>
            </div>
            
            <div class="settings-section">
              <h3>Performance Monitor</h3>
              <div class="performance-info">
                <div class="info-item">
                  <span class="info-label">Active Tabs:</span>
                  <span id="perf-tab-count">0 (0 virtual)</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Memory Usage:</span>
                  <span id="perf-memory">N/A</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Startup Time:</span>
                  <span id="perf-startup">N/A</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Last Tab Switch:</span>
                  <span id="perf-tab-switch">N/A</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Performance Status:</span>
                  <span id="perf-status" class="status-good">Good</span>
                </div>
              </div>
              <div class="performance-actions">
                <button id="perf-cleanup-btn" class="settings-btn perf-action-btn">Clean Memory</button>
                <button id="perf-clear-virtual-btn" class="settings-btn perf-action-btn">Clear Virtual Tabs</button>
              </div>
            </div>
            
            <div class="settings-section">
              <h3>System Info</h3>
              <div class="system-info">
                <div class="info-item">
                  <span class="info-label">Default Mode:</span>
                  <span id="info-default-mode">Preview</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Current Mode:</span>
                  <span id="info-current-mode">Preview</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Monaco Editor:</span>
                  <span id="info-monaco">Loaded</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Mermaid:</span>
                  <span id="info-mermaid">Loaded</span>
                </div>
                <div class="info-item">
                  <span class="info-label">KaTeX:</span>
                  <span id="info-katex">Loaded</span>
                </div>
              </div>
            </div>
            

          </div>
        </div>
      </div>

      <!-- Help Modal -->
      <div id="help-modal" class="help-modal" style="display: none;">
        <div class="help-overlay"></div>
        <div class="help-window">
          <div class="help-header">
            <h2>Help & Shortcuts</h2>
            <button id="help-close-btn" class="help-close-btn">√ó</button>
          </div>
          <div class="help-content">
            <div class="help-section">
              <h3>File Operations</h3>
              <div class="shortcut-list">
                <div class="shortcut-item"><kbd>Ctrl+N</kbd><span>New file</span></div>
                <div class="shortcut-item"><kbd>Ctrl+O</kbd><span>Open file</span></div>
                <div class="shortcut-item"><kbd>Ctrl+S</kbd><span>Save file</span></div>
                <div class="shortcut-item"><kbd>Ctrl+Shift+S</kbd><span>Save as</span></div>
                <div class="shortcut-item"><kbd>Ctrl+W</kbd><span>Close file</span></div>
                <div class="shortcut-item"><kbd>Ctrl+Q</kbd><span>Quit application</span></div>
              </div>
            </div>
            
            <div class="help-section">
              <h3>View Modes</h3>
              <div class="shortcut-list">
                <div class="shortcut-item"><kbd>Ctrl+1</kbd><span>Code mode</span></div>
                <div class="shortcut-item"><kbd>Ctrl+2</kbd><span>Preview mode</span></div>
                <div class="shortcut-item"><kbd>Ctrl+3</kbd><span>Split mode</span></div>
                <div class="shortcut-item"><kbd>F11</kbd><span>Fullscreen mode</span></div>
                <div class="shortcut-item"><kbd>Shift+F11</kbd><span>Distraction-free mode</span></div>
                <div class="shortcut-item"><kbd>Esc</kbd><span>Exit distraction-free</span></div>
              </div>
            </div>
            
            <div class="help-section">
              <h3>Editor Shortcuts</h3>
              <div class="shortcut-list">
                <div class="shortcut-item"><kbd>Ctrl+B</kbd><span>Bold text</span></div>
                <div class="shortcut-item"><kbd>Ctrl+I</kbd><span>Italic text</span></div>
                <div class="shortcut-item"><kbd>Ctrl+Shift+1-3</kbd><span>Headers H1-H3</span></div>
                <div class="shortcut-item"><kbd>Ctrl+Shift+/</kbd><span>Toggle markdown toolbar</span></div>
                <div class="shortcut-item"><kbd>Ctrl+F</kbd><span>Find & Replace</span></div>
                <div class="shortcut-item"><kbd>Ctrl+Z</kbd><span>Undo</span></div>
                <div class="shortcut-item"><kbd>Ctrl+Y</kbd><span>Redo</span></div>
              </div>
            </div>
            
            <div class="help-section">
              <h3>Export & Print</h3>
              <div class="shortcut-list">
                <div class="shortcut-item"><kbd>Ctrl+Shift+E</kbd><span>Export to HTML</span></div>
                <div class="shortcut-item"><kbd>Ctrl+P</kbd><span>Print/Export PDF</span></div>
                <div class="shortcut-item"><kbd>Ctrl+=</kbd><span>Zoom in (Preview)</span></div>
                <div class="shortcut-item"><kbd>Ctrl+-</kbd><span>Zoom out (Preview)</span></div>
                <div class="shortcut-item"><kbd>Ctrl+0</kbd><span>Reset zoom (Preview)</span></div>
              </div>
            </div>
            
            <div class="help-section">
              <h3>Tab Navigation</h3>
              <div class="shortcut-list">
                <div class="shortcut-item"><kbd>Ctrl+Tab</kbd><span>Next tab</span></div>
                <div class="shortcut-item"><kbd>Ctrl+Shift+Tab</kbd><span>Tab modal (all tabs)</span></div>
                <div class="shortcut-item"><kbd>Alt+1-5</kbd> / <kbd>‚åò+1-5</kbd><span>Switch to numbered tab</span></div>
                <div class="shortcut-item"><kbd>Click filename</kbd><span>Tab dropdown (recent 5)</span></div>
                <div class="shortcut-item"><kbd>Right-click tab</kbd><span>Tab context menu</span></div>
              </div>
            </div>        
            <div class="help-section">
              <h3>Application</h3>
              <div class="shortcut-list">
                <div class="shortcut-item"><kbd>Ctrl+T</kbd><span>Toggle theme</span></div>
                <div class="shortcut-item"><kbd>Ctrl+,</kbd><span>Settings</span></div>
                <div class="shortcut-item"><kbd>F1</kbd><span>This help</span></div>
                <div class="shortcut-item"><kbd>F5</kbd><span>Reload file</span></div>
                <div class="shortcut-item"><kbd>Sync Btn</kbd><span>Manual scroll sync</span></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- About Modal -->
      <div id="about-modal" class="about-modal" style="display: none;">
        <div class="about-overlay"></div>
        <div class="about-window">
          <div class="about-header">
            <h2>About Markdown Editor</h2>
            <button id="about-close-btn" class="about-close-btn">√ó</button>
          </div>
          <div class="about-content">
            <div class="about-logo">
              <img src="assets/MarkdownEditorAboutImage.png" alt="Markdown Editor" class="about-image">
              <p class="version">Version 3.1.1</p>
            </div>
            
            <div class="about-description">
              <p>A powerful markdown viewer and editor built with Tauri + Rust + TypeScript.</p>
            </div>
            
            <div class="about-features">
              <h3>Key Features</h3>
              <ul>
                <li><strong>Multi-Tab Interface:</strong> Open multiple files with smart tab management</li>
                <li><strong>Three View Modes:</strong> Code, Preview, and Split view modes</li>
                <li><strong>Monaco Editor:</strong> Professional code editing with syntax highlighting</li>
                <li><strong>Real-Time Preview:</strong> GitHub-flavored markdown with live updates</li>
                <li><strong>Advanced Rendering:</strong> KaTeX math expressions and Mermaid diagrams</li>
                <li><strong>Performance Optimized:</strong> Handles 100+ tabs with virtualization</li>
                <li><strong>Interactive Elements:</strong> Clickable task lists with state persistence</li>
                <li><strong>Export Options:</strong> HTML export and PDF printing</li>
              </ul>
            </div>
            
            <div class="about-credits">
              <h3>Built With</h3>
              <div class="credits-grid">
                <div class="credit-item">
                  <strong>Tauri</strong> - Native app framework
                </div>
                <div class="credit-item">
                  <strong>Monaco Editor</strong> - Code editor
                </div>
                <div class="credit-item">
                  <strong>Marked.js</strong> - Markdown parser
                </div>
                <div class="credit-item">
                  <strong>KaTeX</strong> - Math rendering
                </div>
                <div class="credit-item">
                  <strong>Mermaid</strong> - Diagram rendering
                </div>
                <div class="credit-item">
                  <strong>Highlight.js</strong> - Syntax highlighting
                </div>
              </div>
            </div>
            
            <div class="about-links">
              <h3>Links & Support</h3>
              <div class="link-info">
                <p><a href="https://github.com/travelingbear/markdown-editor" target="_blank">üìö Documentation/Issues</a></p>
                <p><a href="https://buymeacoffee.com/travelingbear" target="_blank">‚òï Buy me a coffee</a></p>
              </div>
            </div>
            
            <div class="about-footer">
              <p>&copy; 2025 Markdown Editor. Licensed under MIT License.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab Modal -->
      <div id="tab-modal" class="tab-modal" style="display: none;">
        <div class="tab-modal-overlay"></div>
        <div class="tab-modal-window">
          <div class="tab-modal-header">
            <h3>Open Tabs</h3>
            <button id="tab-modal-close" class="tab-modal-close">√ó</button>
          </div>
          <div class="tab-modal-content">
            <div class="tab-modal-search">
              <input type="text" id="tab-search" placeholder="Search tabs..." class="tab-search-input">
            </div>
            <div id="tab-modal-list" class="tab-modal-list"></div>
          </div>
        </div>
      </div>

    </div>
    
    <!-- Load security utilities -->
    <script src="/utils/sanitizer.js"></script>
    
    <!-- Load common utilities -->
    <script src="/utils/common.js"></script>
    
    <!-- Load safe IPC wrapper -->
    <script src="/ipc-wrapper.js"></script>
    
    <!-- Load performance optimizer -->
    <script src="/performance-optimizer.js"></script>
    
    <!-- Load component architecture -->
    <script src="/components/BaseComponent.js"></script>
    <script src="/components/DocumentComponent.js"></script>
    <script src="/components/EditorComponent.js"></script>
    <script src="/components/PreviewComponent.js"></script>
    <script src="/components/ToolbarComponent.js"></script>
    <!-- Load tab management components -->
    <script src="/components/TabState.js"></script>
    <script src="/components/TabCollection.js"></script>
    <script src="/components/TabManager.js"></script>
    <script src="/components/MarkdownEditor.js"></script>
    
    <!-- Load main application -->
    <script src="/main.js"></script>
  </body>
</html>