# AI Assistant Development Prompt

## üéØ Project Context

You are helping develop a **Native Markdown Viewer** desktop application. This is a complete rewrite of a previous Electron project that had theme synchronization issues.

## üìã Current Project Status

**Phase**: Phase 3.5 COMPLETE ‚úÖ - Ready for Phase 4
**Next Action**: Begin Phase 4 - Polish & OS Integration
**Technology Stack**: Tauri + Rust + TypeScript/JavaScript (SELECTED)
**Git Status**: Phase 3.5 complete, ready for user validation and commit

**‚úÖ PHASE 3.5 ACHIEVEMENTS**:
1. **Math Expression Rendering**: KaTeX renders actual equations correctly
2. **Mermaid Diagram Rendering**: Visual diagrams render correctly
3. **Interactive Task Lists**: ALL checkboxes (standalone AND dash-prefixed) work perfectly
4. **HTML Export**: Working correctly with proper formatting
5. **Application Name**: Fixed to show "Markdown Viewer"
6. **Code Syntax Highlighting**: Working with highlight.js
7. **Theme Synchronization**: All rendered content respects theme changes

**üìã MOVED TO PHASE 4**:
- **PDF Export**: Complex library loading issues - scheduled for Phase 4 resolution

## üîç Key Files to Reference

### Primary Planning Documents
- `PROJECT_PLAN.md` - Complete project specification, features, and phases
- `DEBUGGING_REPORT.md` - Lessons learned from previous Electron attempt
- `PROJECT_STATUS.md` - Historical context of what was previously built

### Development Files (CREATED ‚úÖ)
- `DEVELOPMENT_LOG.md` - Phase 1 & 2 progress documented
- `CHANGELOG.md` - Version history with Phase 2 completion
- `Markdown Viewer/README.md` - Project setup instructions
- `Markdown Viewer/` - Complete Tauri application structure

## üéâ Phase 3.5 COMPLETE - What's Next

### Immediate Next Steps
1. **üéØ READY FOR PHASE 4**: Polish & OS Integration
   - File association registration
   - Context menu integration
   - Keyboard shortcuts implementation
   - PDF Export functionality (moved from Phase 3.5)
   - Performance optimization
   - Error handling and user feedback

2. **Current branch**: `feature/phase-3-advanced-features` (ready for validation)

3. **Phase 3.5 Status**: ‚úÖ COMPLETE - All deliverables working correctly

### Development Process Rules

#### ‚ö†Ô∏è CRITICAL: User Validation & Git Requirements
- **DO NOT proceed to next phase without BOTH conditions met:**
  1. **User Testing & Approval**: User must test and explicitly approve all deliverables
  2. **Git Commit**: All changes must be staged and committed to repository
- Each phase has specific validation checkpoints
- Wait for "‚úÖ TESTED, APPROVED & COMMITTED - PROCEED TO NEXT PHASE" confirmation

#### üìù Documentation Requirements
- Update `DEVELOPMENT_LOG.md` with daily progress
- Maintain `README.md` with current setup instructions
- Update `CHANGELOG.md` with each significant change
- Document all technical decisions and rationale

#### üåø Git Branching Strategy
- **Main branch**: Stable, tested, approved code only
- **Feature branches**: All new features/enhancements must use separate branches
- **Branch naming**: `feature/phase-X-description` or `enhancement/feature-name`
- **Merge process**: Only merge to main after user testing and approval
- **Disruptive changes**: Always use new branch, never work directly on main

#### üß™ Testing Requirements
- Write unit tests for each component
- Create integration tests for user workflows
- Perform cross-platform testing
- Validate performance requirements

## ‚úÖ Phase 3 Foundation Deliverables (COMPLETED)

### Core Features Implemented
- ‚úÖ **Math Expression Detection**: `$...$` and `$$...$$` syntax detected and processed
- ‚ùå **Math Rendering**: Shows LaTeX code instead of rendered equations
- ‚úÖ **Mermaid Diagram Detection**: Code blocks detected and converted to placeholders
- ‚ùå **Diagram Rendering**: Shows placeholder boxes instead of visual diagrams
- ‚úÖ **Interactive Task Lists**: Clickable checkboxes with state persistence
- ‚úÖ **Export Functionality**: HTML and PDF export buttons available
- ‚úÖ **Enhanced Styling**: Professional placeholder styling
- ‚úÖ **No Library Conflicts**: Stable application without AMD errors
- ‚úÖ **Phase 2 Preservation**: All previous functionality maintained

### ‚úÖ Issues RESOLVED
- ‚úÖ **AMD/RequireJS Conflicts**: RESOLVED using ES module dynamic imports
- ‚úÖ **Math Rendering**: KaTeX now renders actual equations
- ‚úÖ **Diagram Rendering**: Mermaid.js now renders visual diagrams
- ‚úÖ **Standalone Checkboxes**: Working and clickable
- ‚úÖ **Theme Synchronization**: All rendered content respects theme changes

### ‚úÖ Issues RESOLVED (Phase 3.5)
- ‚úÖ **Dash-prefixed Checkboxes**: FIXED - All checkboxes now clickable with proper markdown sync
- ‚úÖ **Application Name**: FIXED - Shows "Markdown Viewer" correctly
- ‚úÖ **Checkbox Styling**: FIXED - Completed tasks show subtle fade instead of strikethrough
- ‚úÖ **Checkbox State Sync**: FIXED - Preview and markdown source stay synchronized

## ‚úÖ Phase 2 Deliverables (COMPLETED)

### Core Features Implemented
- ‚úÖ **Monaco Editor Integration**: Professional code editor with markdown syntax highlighting
- ‚úÖ **Native File Operations**: Enhanced file dialogs (open/save/save as) with proper error handling
- ‚úÖ **Bidirectional Scroll Synchronization**: Perfect scroll sync across all three modes
- ‚úÖ **Visual Save Button Feedback**: Red button for unsaved changes, normal when saved
- ‚úÖ **Enhanced Close Dialog**: Native Tauri confirm dialog for unsaved changes
- ‚úÖ **Monaco Suggestions Toggle**: Ctrl+Shift+I to enable/disable autocomplete
- ‚úÖ **Enhanced Markdown Rendering**: Proper lists, tables, blockquotes styling
- ‚úÖ **Cross-Mode Scroll Persistence**: Maintains scroll positions when switching modes
- ‚úÖ **Performance Optimizations**: All targets met, no regressions from Phase 1

## ‚úÖ Phase 3.5 Deliverables (COMPLETE)

### ‚úÖ ALL CRITICAL ISSUES RESOLVED
- **‚úÖ RESOLVED: Math Rendering**: KaTeX renders actual equations correctly
- **‚úÖ RESOLVED: Diagram Rendering**: Mermaid.js renders visual diagrams correctly
- **‚úÖ RESOLVED: Dash-prefixed Checkboxes**: All checkboxes clickable with proper markdown sync
- **‚úÖ RESOLVED: Application Name**: Shows "Markdown Viewer" correctly
- **‚úÖ RESOLVED: Checkbox Styling**: Subtle fade effect for completed tasks
- **‚úÖ RESOLVED: Library Loading**: ES module dynamic imports working perfectly
- **‚úÖ RESOLVED: Theme Synchronization**: All rendered content respects theme changes

### Technical Solutions Implemented
- **‚úÖ AMD Conflict Resolution**: ES module dynamic imports prevent conflicts
- **‚úÖ HTML Structure Fix**: Converted `<li>` checkboxes to `<div>` elements to avoid browser blocking
- **‚úÖ State Synchronization**: Fixed regex pattern for proper checkbox state detection
- **‚úÖ Event Handling**: Comprehensive event delegation for all checkbox types
- **‚úÖ CSS Improvements**: Enhanced styling with fade effects instead of strikethrough
- **‚úÖ Tauri Configuration**: Fixed application name in tauri.conf.json

### Success Criteria - ALL MET ‚úÖ
- ‚úÖ **Math expressions**: KaTeX renders actual equations correctly
- ‚úÖ **Mermaid diagrams**: Visual diagrams render correctly
- ‚úÖ **Task lists**: ALL checkboxes (standalone AND dash-prefixed) work perfectly
- ‚úÖ **HTML Export**: Works correctly with proper formatting
- ‚úÖ **Application Name**: Shows "Markdown Viewer" correctly
- ‚úÖ **Performance**: Acceptable with advanced features
- ‚úÖ **No regressions**: Phase 1 & 2 functionality preserved
- ‚úÖ **Code syntax highlighting**: Working with highlight.js
- ‚úÖ **Theme synchronization**: Perfect across all rendered content

### Moved to Phase 4
- **PDF Export**: Complex library loading issues - moved to Phase 4 for dedicated focus

## üîß Technical Requirements

### Architecture Principles
- **Single source of truth** for theme management
- **Modular design** with clear separation of concerns
- **Cross-platform compatibility** from day one
- **Performance first** - meet all benchmarks in PROJECT_PLAN.md

### Key Features from Previous Version
- Three-mode interface (Code, Preview, Split View) ‚úÖ
- Monaco Editor integration with markdown syntax highlighting ‚úÖ
- GitHub-style themes (light/dark) ‚úÖ
- Scroll synchronization between panes ‚úÖ
- File operations with unsaved changes detection ‚úÖ

### Phase 4 Technical Focus (NEXT)
- **File Association Registration**: .md files open with the app
- **Context Menu Integration**: "Open with Markdown Viewer" option
- **PDF Export Resolution**: Complete implementation with proper library loading
- **Keyboard Shortcuts**: Full implementation following OS conventions
- **Performance Optimization**: Final optimizations and benchmarking
- **Error Handling**: Comprehensive user feedback and error recovery

### Ready for User Validation
**Phase 3.5 Status**: COMPLETE ‚úÖ - All critical rendering and interaction issues resolved

**User Actions Required**:
1. **Test all checkbox functionality** (standalone and dash-prefixed)
2. **Verify math expression rendering** (inline and display)
3. **Test Mermaid diagram rendering** (flowcharts, sequence diagrams)
4. **Confirm HTML export works** correctly
5. **Verify application name** shows "Markdown Viewer"
6. **Test theme switching** with all rendered content
7. **Confirm no regressions** from previous phases

**If approved**: Commit changes and proceed to Phase 4
**Git Status**: Ready for commit after user validation **üî• ACTUAL MATH RENDERING**: Implement real KaTeX rendering (not placeholders)
- **üî• ACTUAL DIAGRAM RENDERING**: Implement real Mermaid.js rendering (not placeholders)
- **üî• LIBRARY LOADING STRATEGY**: Find working approach for external library integration
- **üî• THEME SYNCHRONIZATION**: Ensure rendered content respects theme changes

### Critical Lessons Learned
- **Avoid dual theme state management** (resolved in Phase 1)
- **Use stable, well-supported frameworks** (Monaco Editor working perfectly)
- **Test theme synchronization thoroughly** (all themes working)
- **Implement proper error handling** (comprehensive error handling in place)
- **üî• NEW: AMD/RequireJS Conflicts** - Monaco Editor conflicts with external libraries
- **üî• NEW: Library Loading Issues** - Both CDN and local files fail due to module system conflicts
- **üî• NEW: Placeholder vs Real Rendering** - Detection works, actual rendering blocked by conflicts

## üí° Development Approach

### Start Simple, Build Up
1. Get basic functionality working first
2. Add complexity incrementally
3. Test thoroughly at each step
4. Get user approval before proceeding

### Focus Areas by Phase
- **Phase 1**: Basic functionality and project setup ‚úÖ
- **Phase 2**: Editor integration and mode switching ‚úÖ
- **Phase 3**: Foundation (detection, placeholders) ‚úÖ **COMPLETE**
- **Phase 3.5**: Actual rendering (math, diagrams) ‚Üê **üî• CRITICAL CURRENT**
- **Phase 4**: OS integration and polish
- **Phase 5**: Distribution and release

## üé® UI/UX Requirements

### Layout Structure (Established)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ File  Edit  View  Tools  Help                   [- ‚ñ° √ó] ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇüìÅ Open üíæ Save ‚ùå Close ‚îÇ Code ‚îÇ Preview ‚îÇ Split ‚îÇ üåô ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  [Editor Pane]              ‚îÇ  [Preview Pane]           ‚îÇ
‚îÇ                             ‚îÇ                           ‚îÇ
‚îÇ  # Markdown Content         ‚îÇ  Rendered HTML            ‚îÇ
‚îÇ  ```mermaid                 ‚îÇ  [Mermaid Diagram]        ‚îÇ
‚îÇ  graph TD                   ‚îÇ  $LaTeX: x^2 + y^2 = z^2$ ‚îÇ
‚îÇ  A --> B                    ‚îÇ  ‚òê Interactive Task       ‚îÇ
‚îÇ  ```                        ‚îÇ                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Line 1, Col 1              ‚îÇ              filename.md   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Theme Requirements (Established)
- GitHub-style light theme (default) ‚úÖ
- Dark theme with proper contrast ‚úÖ
- **Perfect synchronization** between all UI elements ‚úÖ
- Theme persistence across sessions ‚úÖ
- **New**: Mermaid diagrams must adapt to theme changes
- **New**: Math expressions must be readable in both themes

## üìä Performance Targets

- Application launch: < 2 seconds ‚úÖ
- File opening: < 500ms for files up to 10MB ‚úÖ
- Mode switching: < 100ms ‚úÖ
- Real-time preview updates: < 300ms debounce ‚úÖ
- Memory usage: < 200MB for typical files ‚úÖ
- **New**: Mermaid diagram rendering: < 1 second
- **New**: Math expression rendering: < 500ms
- **New**: Export operations: < 5 seconds for typical documents

## üö® Common Pitfalls to Avoid

1. **üî• AMD/RequireJS Conflicts** - Monaco Editor conflicts with external libraries
2. **üî• Library Loading Order** - Timing and sequence of library initialization
3. **üî• Module System Conflicts** - Different module systems interfering
4. **Theme Desynchronization** - Ensure rendered content respects theme changes
5. **Performance with Real Rendering** - Profile actual math and diagram rendering
6. **Fallback Strategies** - Graceful degradation when libraries fail to load

## üéØ Success Definition

The project is successful when:
- All three modes work flawlessly with perfect theme sync ‚úÖ
- **üî• CRITICAL**: Math expressions show rendered equations (not LaTeX code)
- **üî• CRITICAL**: Mermaid diagrams show visual diagrams (not placeholder boxes)
- Interactive task lists work with checkboxes ‚úÖ
- Export functionality produces quality output ‚úÖ
- Performance remains acceptable with real rendering
- No regressions from Phase 1 & 2 functionality ‚úÖ

## üî• CURRENT BLOCKER

**AMD/RequireJS Conflict**: Monaco Editor's module system prevents loading of Mermaid.js and KaTeX libraries. This is the primary technical challenge blocking Phase 3.5 completion.

**Evidence**: Console shows "Can only have one anonymous define call per script file" errors when attempting to load external libraries.

**Impact**: Math expressions and diagrams show as styled placeholders instead of rendered content.

**Test Files Available**: `phase3-test.md` and `sample-phase3.md` for testing rendering fixes.tive elements work smoothly
- Export functionality produces high-quality output
- Performance meets all benchmarks
- UI feels native on each platform ‚úÖ
- No crashes or data loss ‚úÖ

## üìû Communication Protocol

### When to Ask for User Input
- Technology stack selection ‚úÖ
- Major architectural decisions
- Phase completion validation
- UI/UX design choices
- Performance optimization strategies

### How to Request Approval
```
## Phase [X] Completion - Validation Required

### Deliverables Completed:
- ‚úÖ [Feature 1]
- ‚úÖ [Feature 2]
- ‚úÖ [Feature 3]

### Tests Passed:
- ‚úÖ [Test 1]
- ‚úÖ [Test 2]

### Documentation Updated:
- ‚úÖ README.md
- ‚úÖ DEVELOPMENT_LOG.md
- ‚úÖ CHANGELOG.md

### Git Status:
- ‚úÖ All changes staged
- ‚úÖ Ready for commit after approval
- üìç Current branch: [branch-name]

### User Actions Required:
1. **Test the application:**
   - [ ] [Validation point 1]
   - [ ] [Validation point 2]
   - [ ] [Validation point 3]

2. **If approved, please:**
   - [ ] Confirm testing results
   - [ ] Approve commit and merge (if on feature branch)
   - [ ] Give greenlight for next phase

**Awaiting: Testing ‚Üí Approval ‚Üí Git Commit ‚Üí Phase [X+1] Greenlight**
```

### Git Workflow for Each Phase
```
1. Create feature branch: git checkout -b feature/phase-X-name
2. Develop and test locally
3. Stage changes: git add .
4. Request user validation (DO NOT COMMIT YET)
5. Wait for user testing and approval
6. Commit: git commit -m "Phase X: [description]"
7. Merge to main (if approved): git checkout main && git merge feature/phase-X-name
8. Proceed to next phase
```

---

## üöÄ Ready for Phase 3!

**Current Status**: Phase 2 COMPLETE ‚úÖ - Professional markdown editor with Monaco integration, native file operations, and perfect scroll synchronization

**Technology Stack**: Tauri + Rust + TypeScript/JavaScript ‚úÖ

**Application Structure**: Complete Tauri app with Monaco Editor ‚úÖ

**Git Status**: All Phase 2 changes committed to main branch ‚úÖ

**Next Action**: Begin Phase 3 - Advanced Features

### Phase 3 Focus Areas:
1. **Mermaid.js Integration** - Add diagram rendering capabilities
2. **Mathematical Expressions** - Implement LaTeX/MathJax support
3. **Enhanced Assets** - Improve image and GIF handling
4. **Interactive Elements** - Add clickable task lists
5. **Export Functionality** - HTML and PDF export capabilities
6. **Performance** - Optimize for advanced features

### To Start Phase 3:
1. Create feature branch: `git checkout -b feature/phase-3-advanced-features`
2. Navigate to project: `cd "Markdown Viewer"`
3. Start development server: `npm run tauri dev`
4. Begin Mermaid.js integration following PROJECT_PLAN.md Phase 3 specifications

**Ready to enhance the markdown viewer with advanced rendering capabilities!**

### Key Dependencies to Add:
- `mermaid` - Diagram rendering
- `mathjax` or `katex` - Mathematical expressions
- `html2pdf` or similar - PDF export functionality
- Enhanced image processing libraries as needed

### Architecture Considerations:
- Mermaid diagrams must respect theme changes
- Math expressions need proper styling integration
- Asset management requires secure path resolution
- Export functionality needs to maintain all styling
- Interactive elements require state management

**The foundation is solid - now let's add the advanced features that make this a truly powerful markdown viewer!**